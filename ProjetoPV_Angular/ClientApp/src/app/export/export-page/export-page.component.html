<button [disabled]="contas.length <= 0" class="btn-primary btn" (click)="exportAll('excel-contas-table')">Exportar Contas</button>

<div *ngIf="contas.length > 0">
  <div style="width:100%; max-height: 170px; overflow-y:scroll;">
    <table class='table table-striped' aria-labelledby="tableLabel" id="excel-contas-table">
      <thead>
        <tr>
          <th>Conta Id</th>
          <th>Descrição</th>
          <th>Tipo Conta</th>
          <th>Saldo</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let conta of contas" class="colorRow">
          <td>{{ conta.contaId }}</td>
          <td>{{ conta.descricao }}</td>
          <td>{{ conta.tipoConta.descricao}} </td>
          <td>{{ conta.saldo | currency:conta.moeda }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<br /><br />

<button [disabled]="transacoes.length <= 0"class="btn-primary btn" (click)="exportAll('excel-transacoes-table')">Exportar transações</button>
<div *ngIf="transacoes.length > 0">
  <div style="width:100%; max-height: 300px; overflow-y:scroll;">
    <table class='table table-striped' aria-labelledby="tableLabel" id="excel-transacoes-table">
      <thead>
        <tr>
          <th>Descrição</th>
          <th>Tipo Transacao Id</th>
          <th>Categoria</th>
          <th>Conta origem</th>
          <th>Conta destino</th>
          <th>Valor</th>
          <th>Data</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let transacao of transacoes" class="colorRow">
          <td> {{ transacao.descricao }} </td>
          <td> {{ tipotransacao[transacao.tipoTransacaoId] }} </td>
          <td> {{ transacao.categoria.nome }}</td>
          <td> {{ transacao.contaOrigemId }} </td>
          <td> {{ transacao.contaDestinoId }}</td>
          <td> {{ transacao.valor | currency:transacao.moeda}} </td>
          <td> {{ transacao.dataTransacao | date:'dd/mm/yyyy' }} </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<br /> <br />

<div>
  Selecione uma conta para exportar as suas transações:
  <select [(ngModel)]="selectedAccountId" (change)="getSelectedAccount()">
    <option *ngFor="let conta of contas" [value]="conta.contaId">
      {{ conta.descricao }}
    </option>
  </select>
</div>

<button [disabled]="transacoesAccount.length <= 0" class="btn-primary btn" (click)="exportAll('excel-transacoesAccount-table')">Exportar transações da conta {{selectedAccountId}} </button>
<div *ngIf="transacoesAccount.length > 0">
  <div style="width:100%; max-height: 300px; overflow-y:scroll;">
    <table class='table table-striped' aria-labelledby="tableLabel" id="excel-transacoesAccount-table">
      <thead>
        <tr>
          <th>Descrição</th>
          <th>Tipo Transacao</th>
          <th>Conta origem</th>
          <th>Conta destino</th>
          <th>Valor</th>
          <th>Data</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let transacao of transacoesAccount" class="colorRow">
          <td> {{ transacao.descricao }} </td>
          <td> {{ transacao.categoria.nome}}</td>
          <td> {{ transacao.contaOrigemId }} </td>
          <td> {{ transacao.contaDestinoId }}</td>
          <td> {{ transacao.valor | currency:transacao.moeda}} </td>
          <td> {{ transacao.dataTransacao | date:'dd/mm/yyyy' }} </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>





